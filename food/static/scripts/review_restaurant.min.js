!function(){"use strict";var t=getParameterByName("restaurant_id");$.getJSON(window.apiUrl+"/restaurant/"+t+"/"+window.username+"/",function(t){$(".sub-name").text("Reviewing "+t.name),$(".restaurant-name").text(t.name)}),$(".review-text").click(function(){$(".main-div").animate({scrollTop:$(document).height()})});var e=0;$(".star").click(function(){e=parseInt($(this).data("position")),$(".star").removeClass("selected");for(var t=0;e>t;t++)$(".star:eq("+t+")").addClass("selected")});var i="";$(".review-text").bind("input propertychange",function(){return $("#reviewtext").val().length>140?($("#reviewtext").val(i),void 0):(i=$("#reviewtext").val(),$(".word-left").text(140-i.length),void 0)});var n="";$.getJSON(window.apiUrl+"/photos/list/",function(t){var e=$("#review-template").html(),i=Handlebars.compile(e);$(".photo-container").html(i(t)),$(".photo img:eq(0)").load(function(){var e=$(".photo-container .photo").width();$(".photo-container").width(e*t.length-4)})}).done(function(){$(".photo").click(function(){$(".photo").removeClass("selected"),$(this).addClass("selected"),n=$(this).data("value")})}),$(".submit-review").click(function(){var a=!0;0===i.length&&($(".instructions.text").text("Please enter a review to continue").addClass("error"),$(".main-div").animate({scrollTop:$(document).height()},0),a=!1),0===e&&($(".instructions.rating").text("Please give a rating to continue").addClass("error"),$(".main-div").animate({scrollTop:0},0),a=!1),0===n.length&&($(".instructions.photo").text("Please select a photo continue").addClass("error"),$(".main-div").animate({scrollTop:0},0),a=!1),a&&$.post(window.apiUrl+"/review/"+window.username+"/",{restaurant_id:t,rating:e,text:i,photo:n},function(e){console.log(e),window.location="restaurant.html?id="+t+"&nav=reviews&review_id="+e.review.id})})}();