function initializemap(){"use strict";if(null===mapInfo)return setTimeout(function(){initializemap()},50),console.log("wait"),void 0;var t={center:{lat:parseFloat(mapInfo.location_x),lng:parseFloat(mapInfo.location_y)},zoom:14,mapTypeControl:!1,scaleControl:!1,zoomControl:!1,draggable:!1,streetViewControl:!1},a=new google.maps.Map(document.getElementById("map-canvas"),t),o=new google.maps.LatLng(parseFloat(mapInfo.location_x),parseFloat(mapInfo.location_y)),e=new google.maps.Marker({position:o,map:a,title:name});e.setMap(a),mapLoaded=!0}!function(){"use strict";function t(){$.getJSON(window.apiUrl+"/restaurant/"+d+"/"+window.username+"/",function(t){n=t.foods,s=t.deals,m=t.reviews,mapInfo={location_x:t.location_x,location_y:t.location_y,name:t.name},console.log(t),$(".sub-name").text(t.name),$(".main-div").html(u(t)).promise().done(function(){a()}),$(".review-button").click(function(){window.location="review-restaurant.html?restaurant_id="+t.restaurant_id})})}function a(){mapLoaded&&initializemap(),"reviews"===getParameterByName("nav")&&setTimeout(function(){$(".infopage").eq(2).click();var t=getParameterByName("review_id");$(".review-items").children().each(function(){return parseInt(t)===parseInt($(this).data("id"))?($(this).click(),void 0):void 0})},500),$(".follow-button").click(function(a){var o=$(this).data("id");$.getJSON(window.apiUrl+"/restaurant/follow/"+o+"/"+window.username+"/",function(){t()}),$(this).toggleClass("following"),a.stopPropagation()}),$(".share-button").click(function(){if($(this).toggleClass("clicked"),$(this).hasClass("clicked")){$(this).attr("src","images/icons/share.svg"),$(".circle.share").show(),$(".circle.share").css({opacity:1});var t=$(".circle.share"),a=Math.PI/4*2/t.length,o=0,e=0,i=Math.PI/2;$(".circle.share").each(function(){o=150*Math.cos(i),e=160*Math.sin(i)-45,$(this).animate({right:o,top:e}),i-=a})}else $(".circle.share").animate({right:0,top:0,opacity:0},function(){$(".circle.share").hide(),$(".share-button").attr("src","images/icons/share-o.svg")})});var a;$(".circle.share").click(function(){var t=$(this).data("type");clearTimeout(a),$(".share-confirmation").show(),$(".share-confirmation .site").text(t),$(".share-confirmation").animate({bottom:15,opacity:1},500,function(){a=setTimeout(function(){$(".share-confirmation").animate({bottom:-100,opacity:0},function(){$(".share-confirmation").hide()})},1500)})}),$(".menu-items .modal-button").click(function(){l=$(this).data("index"),o(l);var t=$(this).attr("id");$("#modal-"+t).addClass("open"),$("#modal-"+t+" .modal").animate({marginTop:$(window).height()/9})}),$(".review-items .modal-button").click(function(){c=$(this).data("index"),e(c);var t=$(this).attr("id");$("#modal-"+t).addClass("open"),$("#modal-"+t+" .modal").animate({marginTop:$(window).height()/9})}),$(".deal-items .modal-button").click(function(){r=$(this).data("index"),i(r);var t=$(this).attr("id");$("#modal-"+t).addClass("open"),$("#modal-"+t+" .modal").animate({marginTop:$(window).height()/11})})}function o(t){var a=0!==t,e=t!==n.length-1;$("#modal-menu-item .modal").html(f({not_first:a,not_last:e,item:n[t]})),addCloseButton("menu-item");var i=$("#modal-menu-item .photo img").width();$("#modal-menu-item .photo img").height(i),$(".controls .right").click(function(t){l!==n.length-1&&(o(++l),t.stopPropagation())}),$(".controls .left").click(function(t){0!==l&&(o(--l),t.stopPropagation())})}function e(t){var a=0!==t,o=t!==m.length-1;$("#modal-review-item .modal").html(b({not_first:a,not_last:o,item:m[t]})),addCloseButton("review-item");var i=$("#modal-review-item .photo img").width();$("#modal-review-item .photo img").height(i);var n=$("#modal-review-item .modal").height(),l=$("#modal-review-item .info").height(),s=l+i-n;$("#modal-review-item .modal").height(n+s+20),$(".controls .right").click(function(t){c!==m.length-1&&(e(++c),t.stopPropagation())}),$(".controls .left").click(function(t){0!==c&&(e(--c),t.stopPropagation())})}function i(t){var a=0!==t,o=t!==s.length-1;$("#modal-restaurant-deals .modal").html(v({not_first:a,not_last:o,deals:s[t]})),addCloseButton("restaurant-deals");var e=$("#modal-restaurant-deals .photo img").width();$("#modal-restaurant-deals .photo img").height(e);var n=$("#modal-restaurant-deals .modal").height(),l=$("#modal-restaurant-deals .info").height(),m=l+e-n;$("#modal-restaurant-deals .modal").height(n+m+20),$(".controls .right").click(function(t){r!==s.length-1&&(i(++r),t.stopPropagation())}),$(".controls .left").click(function(t){0!==r&&(i(--r),t.stopPropagation())})}var n,l,s,r,m,c,d=getParameterByName("id"),h=$("#restaurant-template").html(),u=Handlebars.compile(h),p=$("#menu-template").html(),f=Handlebars.compile(p),g=$("#deals-template").html(),v=Handlebars.compile(g),w=$("#review-template").html(),b=Handlebars.compile(w),k=!1;$(".main-div").scroll(function(){var t=-$(".main-photo").offset().top-$(".main-div").offset().top;return t>5?($(".sub-nav").removeClass("hidden"),t>100&&(t=100),$(".sub-nav").css({opacity:t/100}),k||$(".sub-nav").children().each(function(){var t=$(this).data("anchor"),a=$("."+t).offset().top-$(".main-div").offset().top-$(".sub-nav").offset().top;0>a&&($(".sub-nav-item").removeClass("selected"),$(this).addClass("selected"))}),void 0):($(".sub-nav").addClass("hidden"),void 0)}),$(".sub-nav-item").click(function(){$(".sub-nav-item").removeClass("selected"),$(this).addClass("selected");var t=$(this).data("anchor");k=!0,$(".main-div").animate({scrollTop:$("."+t).offset().top-$(".main-photo").offset().top-$(".sub-nav").height()},1e3,function(){k=!1})}),t()}();var mapInfo=null,mapLoaded=!1;