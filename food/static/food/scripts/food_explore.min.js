!function(){"use strict";function e(){v=new Hammer(p),v.on("panleft panright",function(e){return clearTimeout(k),4===e.eventType?(u.animate({left:0,top:0},100),void 0):(e.deltaX<-100&&w.click(),e.deltaX>100&&g.click(),u.css({left:e.deltaX}),k=setTimeout(function(){u.animate({left:0,top:0},100)},500),void 0)}),v.on("doubletap",function(){$(".info-button").click()})}function t(e){localStorage.setItem("preferences",e),console.log(localStorage.getItem("preferences")),$.getJSON(window.apiUrl+"/food/list/"+window.username+"/?explore=true"+e,function(e){a=e,i(0)}).done(function(){null===localStorage.getItem("firsttime")&&($(".controls .fa-question-circle").click(),localStorage.setItem("firsttime",!0))})}function o(t){var o,n="-100%";t?(n="100%",o=$(".likestamp")):o=$(".dislikestamp"),o.addClass("displayed"),setTimeout(function(){o.removeClass("displayed")},500),u.animate({left:n,top:0,opacity:0},500,function(){i(++d),u.css({left:0,opacity:1}),e()})}function i(e){return e>a.length-1?(u.attr("src","images/error.svg"),v.off("panleft panright tap press swipeleft swiperight"),$(".info").html(""),void 0):($(".info").html(l(a[e])),u.attr("src","images/"+a[e].photo),e+1!==a.length?(m.attr("src","images/"+a[e+1].photo),e+2!==a.length&&m.css("background-image","url(images/"+a[e+2].photo+")")):m.attr("src","images/error.svg"),void 0)}var n=new Date;n=n.getTime(),0===$("#reloadValue").val().length?($("#reloadValue").val(n),$("body").show()):($("#reloadValue").val(""),location.reload());var a,s=$("#food-template").html(),l=Handlebars.compile(s),r=$("#history-template").html(),c=Handlebars.compile(r),d=0,f="";localStorage.getItem("preferences")&&(f=localStorage.getItem("preferences"),-1===window.location.toString().indexOf("?")&&(window.location=window.location.toString().split("?")[0]+"?explore=true"+f)),t(f);var p=document.getElementById("food-photo"),u=$("#food-photo img"),m=$("#food-photo2 img"),g=$(".controls .fa-thumbs-o-up").parent(),w=$(".controls .fa-thumbs-o-down").parent();w.click(function(e){if(0===u.offset().left||!e.hasOwnProperty("originalEvent")){var t="";e.hasOwnProperty("originalEvent")||(t="?swipe=true"),v.off("panleft panright tap press swipeleft swiperight"),$.getJSON(window.apiUrl+"/food/dislike/"+a[d].id+"/"+window.username+"/"+t,function(){o(!1)})}}),g.click(function(e){if(0===u.offset().left||!e.hasOwnProperty("originalEvent")){var t="";e.hasOwnProperty("originalEvent")||(t="?swipe=true"),v.off("panleft panright tap press swipeleft swiperight"),$.getJSON(window.apiUrl+"/food/like/"+a[d].id+"/"+window.username+"/"+t,function(){o(!0)})}}),$(".controls .fa-question-circle").parent().click(function(){$(".instructions").fadeToggle()}),$(".controls .fa-history").parent().click(function(){var e="history";$("#modal-"+e).addClass("open"),$("#modal-"+e+" .modal").animate({marginTop:90}),addCloseButton(e),$.getJSON(window.apiUrl+"/food/history/"+window.username+"/",function(e){console.log(e),$(".modal .closebutton").click(function(){$(".main-buttons #close").click()}),$("#modal-history .history-list").html(c(e)).promise().done(function(){$(".buttons .like").click(function(e){e.stopPropagation();var t=$(this);if(!t.hasClass("selected")){var o=$(this).parent().find(".dislike"),i=$(this).parent().find(".clearlike"),n=t.data("id");$.getJSON(window.apiUrl+"/food/like/"+n+"/"+window.username+"/",function(){t.addClass("selected"),o.removeClass("selected"),i.removeClass("selected")})}}),$(".buttons .dislike").click(function(e){e.stopPropagation();var t=$(this);if(!t.hasClass("selected")){var o=$(this).parent().find(".like"),i=$(this).parent().find(".clearlike"),n=t.data("id");$.getJSON(window.apiUrl+"/food/dislike/"+n+"/"+window.username+"/",function(){t.addClass("selected"),o.removeClass("selected"),i.removeClass("selected")})}}),$(".buttons .clearlike").click(function(e){e.stopPropagation();var t=$(this).data("id"),o=$(this),i=o.parent().find(".like"),n=o.parent().find(".dislike");$.getJSON(window.apiUrl+"/food/reset/"+t+"/"+window.username+"/",function(){o.addClass("selected"),i.removeClass("selected"),n.removeClass("selected")})})})})}),$(".main-buttons #close").click(function(){$(".modal-wrapper.open").click(),$(".main-buttons .submit").click()}),$(".dismiss-button").click(function(){$(".instructions").fadeOut()});var h;$(".controls .circle").click(function(){h=$(this),h.addClass("clicked"),setTimeout(function(){h.removeClass("clicked")},400)}),$(".food-container").css({height:$(window).width()}),$("#food-photo img, #food-photo2 img").css({height:$(window).width()}),e();var k,v;$(".main-buttons .submit").click(function(){var e=getSearchQueryFood();t(e)})}();